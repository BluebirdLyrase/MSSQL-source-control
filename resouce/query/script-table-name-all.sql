== == == == == == == == == == == == == == == == == == == == == == = -- Author:  preeyanoot.suw  -- Create date: 2023-11-10  -- Description:     /*    SELECT  [dbo].[HRMF_CheckUniformDocStatus]('TS66001','')    SELECT  [dbo].[HRMF_CheckUniformDocStatus]('RM66001','')    SELECT  [dbo].[HRMF_CheckUniformDocStatus]('RM66003','')      SELECT  [dbo].[HRMF_CheckUniformDocStatus]('TS66001','20')  */  -- =============================================  CREATE FUNCTION [dbo].[HRMF_CheckUniformDocStatus](    @userID            VARCHAR(20),    @approveStatus     INT = ''  )    RETURNS VARCHAR(20)  AS  BEGIN   /*    10 = รอหัวหน้าอนุมัติ    20 = รอ HR อนุมัติ    30 = อนุมัติสำเร็จ    40  = ไม่ผ่านอนุมัติ   */   DECLARE @docStatus INT   DECLARE @isHR BIT = (SELECT IIF(departmentNo IN ('HR','HR01'), 1, 0)  FROM [Data_AuthenCentral].[dbo].[ATCT_User] WHERE userID = @userID)   DECLARE @isBoss BIT = (SELECT TOP 1 IIF(userID <> '', 1, 0)  FROM [dbo].[HRMT_Approve_Flow] WHERE userID = @userID AND activeStatus = 1)     SELECT TOP 1     @docStatus = CASE         WHEN  @approveStatus = 20    THEN 40         WHEN  @isHR  = 'true'     THEN 30        WHEN  @isBoss = 'true'     THEN 20        ELSE 10       END      RETURN @docStatus    END